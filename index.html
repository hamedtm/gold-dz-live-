<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø°Ù‡Ø¨ - GOLD DZ LIVE</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #ffd700; --dark-gold: #b8860b; --bg: #f4f4f4; --text: #333; --card: #fff; }
        body.dark-mode { --bg: #0a192f; --text: #fff; --card: #112240; }
        body { font-family: 'Tajawal', sans-serif; background-color: var(--bg); color: var(--text); margin: 0; padding: 15px; transition: 0.3s; text-align: center; }
        .header { background: linear-gradient(135deg, var(--gold), var(--dark-gold)); color: #000; padding: 20px; border-radius: 15px; margin-bottom: 20px; position: relative; }
        .price-card { background: var(--card); padding: 15px; border-radius: 12px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; border: 1px solid var(--gold); }
        .value { color: var(--dark-gold); font-size: 1.2em; font-weight: 800; }
        .alert-box { background: var(--card); border: 2px solid var(--gold); border-radius: 15px; padding: 15px; margin-top: 20px; text-align: right; }
        select, input { width: 100%; padding: 10px; margin: 5px 0 15px 0; border-radius: 8px; border: 1px solid #ccc; font-family: 'Tajawal'; box-sizing: border-box; }
        .btn-alert { background: var(--dark-gold); color: white; border: none; padding: 12px; border-radius: 8px; width: 100%; font-weight: bold; cursor: pointer; }
        #ayah-popup { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; color: black; padding: 20px; border-radius: 15px; border: 3px solid var(--gold); z-index: 1000; width: 85%; }
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 999; }
        .theme-btn { position: absolute; top: 10px; left: 10px; background: rgba(255,255,255,0.3); border: none; border-radius: 5px; padding: 5px; cursor: pointer; }
    </style>
</head>
<body id="mainBody">

    <div class="header">
        <button class="theme-btn" onclick="toggleTheme()">â˜€ï¸/ğŸŒ™</button>
        <h1 id="ayah-trigger" style="cursor:pointer; margin:0;">Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø°Ù‡Ø¨ Ù…Ø¨Ø§Ø´Ø± ğŸ’°</h1>
        <p>ØªØ­Ø¯ÙŠØ« Ù…Ø¨Ø§Ø´Ø± (Ø§Ù„Ø³ÙƒÙˆØ§Ø± 245)</p>
    </div>

    <div id="prices">
        <div class="price-card"><span>Ø¹ÙŠØ§Ø± 24:</span> <span class="value" id="g24">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±Ø¨Ø·...</span></div>
        <div class="price-card"><span>Ø¹ÙŠØ§Ø± 21:</span> <span class="value" id="g21">...</span></div>
        <div class="price-card"><span>Ø¹ÙŠØ§Ø± 18:</span> <span class="value" id="g18">...</span></div>
    </div>

    <div class="alert-box">
        <h3>ğŸ”” Ø¥Ø¹Ø¯Ø§Ø¯ ØªÙ†Ø¨ÙŠÙ‡ Ø°ÙƒÙŠ</h3>
        <label>Ø§Ù„Ø¹ÙŠØ§Ø±:</label>
        <select id="karatSelect"><option value="24">24</option><option value="21" selected>21</option><option value="18">18</option></select>
        <label>Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø¹Ù†Ø¯:</label>
        <select id="conditionSelect"><option value="up">Ø§Ù„ØµØ¹ÙˆØ¯ ÙÙˆÙ‚ â†‘</option><option value="down">Ø§Ù„Ù†Ø²ÙˆÙ„ ØªØ­Øª â†“</option></select>
        <input type="number" id="targetPrice" placeholder="Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (Ø¯Ø¬)">
        <select id="methodSelect" onchange="toggleEmailInput()"><option value="tg">ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…</option><option value="mail">Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„</option></select>
        <input type="email" id="userEmail" placeholder="Ø¥ÙŠÙ…ÙŠÙ„Ùƒ Ø§Ù„Ø´Ø®ØµÙŠ" style="display:none;">
        <button class="btn-alert" onclick="saveSmartAlert()">ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ âœ…</button>
    </div>

    <div class="overlay" id="overlay" onclick="closePopup()"></div>
    <div id="ayah-popup">
        <p id="ayah-text">"ÙˆÙÙÙÙŠ Ø§Ù„Ø³Ù‘ÙÙ…ÙØ§Ø¡Ù Ø±ÙØ²Ù’Ù‚ÙÙƒÙÙ…Ù’ ÙˆÙÙ…ÙØ§ ØªÙÙˆØ¹ÙØ¯ÙÙˆÙ†Ù"</p>
        <button onclick="copyAyah()" style="padding:10px; background:var(--gold); border:none; border-radius:5px;">Ù†Ø³Ø® Ø§Ù„Ø¢ÙŠØ©</button>
        <button onclick="closePopup()" style="padding:10px; background:#eee; border:none; border-radius:5px;">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>

    <script>
        Telegram.WebApp.ready();
        emailjs.init("vFHwfkXDe3GRCujAa");

        // Ù†Ø¸Ø§Ù… Ù…Ø­Ø³Ù† Ù„Ø¶Ù…Ø§Ù† Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø§Ù„ØªØ²Ø§Ù…Ù† Ù…Ø¹ Ø¨ÙŠÙ†Ø§Ù†Øµ
        function connectBinance() {
            const ws = new WebSocket('wss://stream.binance.com:9443/ws/paxgusdt@ticker');
            ws.onmessage = (e) => {
                const price = parseFloat(JSON.parse(e.data).c);
                const p24 = (price / 31.1034) * 245;
                document.getElementById('g24').innerText = Math.round(p24).toLocaleString() + " Ø¯Ø¬";
                document.getElementById('g21').innerText = Math.round(p24 * 0.875).toLocaleString() + " Ø¯Ø¬";
                document.getElementById('g18').innerText = Math.round(p24 * 0.75).toLocaleString() + " Ø¯Ø¬";
            };
            ws.onclose = () => { setTimeout(connectBinance, 2000); }; // Ø¥Ø¹Ø§Ø¯Ø© Ø§ØªØµØ§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙÙŠ Ø­Ø§Ù„ Ø§Ù„Ø§Ù†Ù‚Ø·Ø§Ø¹
        }
        connectBinance();

        function toggleTheme() { document.getElementById('mainBody').classList.toggle('dark-mode'); }
        function toggleEmailInput() { document.getElementById('userEmail').style.display = (document.getElementById('methodSelect').value === 'mail') ? 'block' : 'none'; }

        function saveSmartAlert() {
            const price = document.getElementById('targetPrice').value;
            const email = document.getElementById('userEmail').value;
            const method = document.getElementById('methodSelect').value;

            if(!price) return alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø³Ø¹Ø±!");

            if(method === 'mail') {
                if(!email) return alert("Ø£Ø¯Ø®Ù„ Ø¥ÙŠÙ…ÙŠÙ„Ùƒ!");
                // ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ ÙˆØ¥Ø¶Ø§ÙØ© ÙƒØ§Ø´Ù Ø£Ø®Ø·Ø§Ø¡
                emailjs.send("service_fsuxp7k", "template_cfpavnj", {
                    to_email: email,
                    karat: document.getElementById('karatSelect').value,
                    price: price,
                    condition: document.getElementById('conditionSelect').value === 'up' ? 'Ø§Ø±ØªÙØ§Ø¹' : 'Ø§Ù†Ø®ÙØ§Ø¶'
                }).then(
                    () => Telegram.WebApp.showAlert("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ! ØªÙÙ‚Ø¯ Ø¥ÙŠÙ…ÙŠÙ„Ùƒ Ø§Ù„Ø¢Ù† (ÙˆØ§Ù„Ù€ Junk)."),
                    (error) => Telegram.WebApp.showAlert("âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: " + JSON.stringify(error))
                );
            } else {
                Telegram.WebApp.showAlert("âœ… ØªÙ… ØªÙØ¹ÙŠÙ„ ØªÙ†Ø¨ÙŠÙ‡ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­!");
            }
        }

        document.getElementById('ayah-trigger').addEventListener('dblclick', () => {
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('ayah-popup').style.display = 'block';
        });
        function closePopup() { document.getElementById('overlay').style.display = 'none'; document.getElementById('ayah-popup').style.display = 'none'; }
        function copyAyah() { navigator.clipboard.writeText(document.getElementById('ayah-text').innerText); alert("ØªÙ… Ø§Ù„Ù†Ø³Ø®!"); }
    </script>
</body>
</html>
